<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Pookie Pomodoro - 30/10</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Ancizar+Sans:ital,wght@0,100..1000;1,100..1000&display=swap" rel="stylesheet">
  <link rel="shortcut icon" href="cookie.png" type="image/x-icon">
  <link rel="stylesheet" href="style.css">
</head>
<body class="bg-amber-200 mb-8">

  <main>

    <!-- Work Screen -->
    <div id="work-screen" class="h-screen flex flex-col md:flex-row justify-evenly items-center p-4 text-center gap-6">
      <img class="w-72 sm:w-80 md:w-96 max-w-full h-auto" src="mango1.png" alt="Matcha">
      <div class="w-full md:w-1/2 text-center">
        <h2 class="text-2xl sm:text-3xl md:text-4xl font-semibold mb-6 tracking-widest">DO NOT DISTURB</h2>
        <div class="flex justify-center gap-4 text-9xl font-bold">
          <span id="work-minutes">30</span>:<span id="work-seconds">00</span>
        </div>
        <div class="text-sm mt-2">
          <span>minutes</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>seconds</span>
        </div>
      </div>
    </div>

    <!-- Break Screen -->
    <div id="break-screen" class="h-screen hidden flex-col md:flex-row justify-evenly items-center p-4 text-center gap-6">
      <div class="w-full md:w-1/2 text-center">
        <h2 class="text-2xl sm:text-3xl md:text-4xl font-semibold mb-6 tracking-widest">TAKE A BREAK</h2>
        <div class="flex justify-center gap-4 text-9xl font-bold">
          <span id="break-minutes">10</span>:<span id="break-seconds">00</span>
        </div>
        <div class="text-sm mt-2">
          <span>minutes</span> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span>seconds</span>
        </div>
      </div>
      <img class="w-72 sm:w-80 md:w-96 max-w-full h-auto" src="orange1.png" alt="Matcha">
    </div>

  </main>

  <!-- Music Controls -->
  <div class="mt-6 flex flex-col items-center gap-4">
    <div class="flex gap-4">
      <button id="play-music" type="button" class="w-28 h-10 sm:w-32 sm:h-10 text-white bg-amber-400 rounded-full shadow transition-all duration-400 hover:shadow-xl hover:shadow-amber-500/60 focus:outline-none focus:ring-2 focus:ring-amber-400 flex justify-center items-center">
        <!-- Play SVG icon -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.347a1.125 1.125 0 0 1 0 1.972l-11.54 6.347a1.125 1.125 0 0 1-1.667-.986V5.653Z" />
        </svg>
      </button>
      <button id="toggle-mute" type="button" class="w-28 h-10 sm:w-32 sm:h-10 text-white bg-amber-400 rounded-full shadow transition-all duration-400 hover:shadow-xl hover:shadow-amber-500/60 focus:outline-none focus:ring-2 focus:ring-amber-400 flex justify-center items-center">
        <!-- Unmute SVG icon initially -->
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />
        </svg>
      </button>
    </div>

    <div class="flex items-center gap-4 mt-2">
      <input
        type="range"
        id="volume-slider"
        min="0"
        max="1"
        step="0.01"
        value="0.5"
        class="w-40 accent-amber-400 cursor-pointer"
      />
    </div>
  </div>

  <audio id="background-music"></audio>

  <script>
    // Pomodoro logic
    let workDuration = 30 * 60;
    let breakDuration = 10 * 60;
    let isWork = true;
    let intervalId;

    function startTimer(duration, updateFn, doneFn) {
      let time = duration;
      updateFn(time);
      intervalId = setInterval(() => {
        time--;
        updateFn(time);
        if (time <= 0) {
          clearInterval(intervalId);
          doneFn();
        }
      }, 1000);
    }

    function updateTimeDisplay(prefix, time) {
      const mins = String(Math.floor(time / 60)).padStart(2, '0');
      const secs = String(time % 60).padStart(2, '0');
      document.getElementById(`${prefix}-minutes`).textContent = mins;
      document.getElementById(`${prefix}-seconds`).textContent = secs;
    }

    function switchScreens() {
      const workScreen = document.getElementById("work-screen");
      const breakScreen = document.getElementById("break-screen");

      if (isWork) {
        workScreen.classList.replace("flex", "hidden");
        breakScreen.classList.replace("hidden", "flex");
        isWork = false;
        startTimer(breakDuration, (t) => updateTimeDisplay("break", t), switchScreens);
      } else {
        breakScreen.classList.replace("flex", "hidden");
        workScreen.classList.replace("hidden", "flex");
        isWork = true;
        startTimer(workDuration, (t) => updateTimeDisplay("work", t), switchScreens);
      }
    }

    startTimer(workDuration, (t) => updateTimeDisplay("work", t), switchScreens);

    // Audio logic
    // All music files are in the 'music/' folder
    const fileNames = [
      'lofi1.mp3', 
      'lofi2.mp3', 
      'lofi3.mp3',
      'lofi4.mp3',
      'lofi5.mp3',
      'lofi6.mp3',
      'lofi7.mp3',
      'lofi8.mp3',
      'lofi9.mp3',
    ];
    const tracks = fileNames.map(name => `music/${name}`);
    let shuffledTracks = [...tracks];
    let currentTrackIndex = 0;
    let bgMusic = document.getElementById("background-music");

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    shuffle(shuffledTracks);
    bgMusic.src = shuffledTracks[currentTrackIndex];
    bgMusic.loop = false;

    function playNextTrack() {
      currentTrackIndex++;
      if (currentTrackIndex >= shuffledTracks.length) {
        shuffle(shuffledTracks);
        currentTrackIndex = 0;
      }
      bgMusic.src = shuffledTracks[currentTrackIndex];
      bgMusic.play();
    }

    bgMusic.addEventListener('ended', playNextTrack);

    // UI controls
    const playBtn = document.getElementById("play-music");
    const muteBtn = document.getElementById("toggle-mute");
    const volumeSlider = document.getElementById("volume-slider");

    const muteSVG = `
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M17.25 9.75 19.5 12m0 0 2.25 2.25M19.5 12l2.25-2.25M19.5 12l-2.25 2.25m-10.5-6 4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />
      </svg>`;

    const unmuteSVG = `
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z" />
      </svg>`;

    let isMuted = false;
    muteBtn.innerHTML = unmuteSVG;

    let hasStartedMusic = false;
    function startMusic() {
      if (!hasStartedMusic) {
        bgMusic.play();
        hasStartedMusic = true;
      }
    }

    playBtn.addEventListener("click", startMusic);
    document.addEventListener("click", startMusic, { once: true });
    document.addEventListener("keydown", startMusic, { once: true });

    muteBtn.addEventListener("click", () => {
      isMuted = !isMuted;
      bgMusic.muted = isMuted;
      muteBtn.innerHTML = isMuted ? muteSVG : unmuteSVG;
    });

    bgMusic.volume = 0.5;
    volumeSlider.value = 0.5;

    volumeSlider.addEventListener("input", () => {
      bgMusic.volume = parseFloat(volumeSlider.value);
    });
  </script>

</body>
</html>
